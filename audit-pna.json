{
	"mode": "All",
	"policyRule": {
		"if": {
			"allOf": [
				{
					"field": "type",
					"in": "[parameters('publicNetworkAccessAvailableResourceTypes')]"
				},
				{
					"value": "[concat(field('type'), '/publicNetwokAccess')]",
					"like": "Disabled"
				}
			]

		},
		"then": {
			"effect": "[parameters('effect')]"
		}
	},
	"parameters": {
		"effect":{
			"type": "String",
			"metadata": {
				"displayName": "Select the effect of this policy",
				"description": "Configures the effect of this policy. Default value is Audit."
			},
			"defaultValue": "Audit",
			"allowedValues": [
				"Audit",
				"Disabled"
			]
		},
		"publicNetworkAccessAvailableResourceTypes": {
			"type": "Array",
			"metadata": {
				"displayName": "Resource types evaluated by this policy",
				"description": "Collection of resource types that support restricting public network access"
			},
			"defaultValue": [
				"Microsoft.AppConfiguration/configurationStores",
				"Microsoft.Automation/automationAccounts",
				"Microsoft.Batch/batchAccounts",
				"Microsoft.Cache/Redis",
				"Microsoft.CognitiveServices/accounts",
				"Microsoft.ContainerRegistry/registries",
				"Microsoft.DataFactory/factories",
				"Microsoft.DBforMariaDB/servers",
				"Microsoft.DBForMySql/flexibleServers",
				"Microsoft.DBforMySQL/servers",
				"Microsoft.DBForPostgreSql/flexibleServers",
				"Microsoft.DBforPostgreSQL/servers",
				"Microsoft.Devices/IotHubs",
				"Microsoft.Devices/provisioningServices",
				"Microsoft.DigitalTwins/digitalTwinsInstances",
				"Microsoft.DocumentDB/databaseAccounts",
				"Microsoft.EventGrid/domains",
				"Microsoft.EventGrid/topics",
				"Microsoft.HealthcareApis/services",
				"Microsoft.HybridCompute/privateLinkScopes",
				"Microsoft.Migrate/assessmentProjects",
				"Microsoft.Purview/accounts",
				"Microsoft.Search/searchServices",
				"Microsoft.SignalRService/webPubSub",
				"Microsoft.Sql/servers",
				"Microsoft.Synapse/workspaces",
				"Microsoft.Web/sites/config",
				"Microsoft.Web/sites/slots/config"
			]
		}
	}
}