{
	"mode": "All",
	"policyRule": {
		"if": {
			"allOf": [
				{
					"field": "type",
					"in": "Microsoft.Network/privateEndpoints"
				},
				{
					"anyOf": [
						{
							"value": "[split('Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId', '/')[2]]",
							"notIn": "[parameters('allowedSubscriptions')]"
						},
						{
							"value": "[split('Microsoft.Network/privateEndpoints/manualPrivateLinkServiceConnections[*].privateLinkServiceId', '/')[2]]",
							"notIn": "[parameters('allowedSubscriptions')]"
						}
					]
				}
			]
		},
		"then": {
			"effect": "[parameters('effect')]"
		}
	},
	"parameters": {
		"effect": {
			"type": "String",
			"metadata": {
				"displayName": "Select the effect of this policy",
				"description": "Configures the effect of this policy. Default value is Audit."
			},
			"defaultValue": "Audit",
			"allowedValues": [
				"Audit",
				"Deny",
				"Disabled"
			]
		},
		"allowedSubscriptions": {
			"type": "Array",
			"metadata": {
				"displayName": "Allowed subscriptions",
				"description": "List of subscriptions that contain resources allowed as a target for a Private Endpoint"
			}
		}
	}
}